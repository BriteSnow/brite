var brite=brite||{};brite.version="0.9.0-snapshot";(function(e){var b=0;var d={};var l={};var m={};var h={};brite.registerView=function(t,s,v){var u={};u.name=t;u.componentFactory=v;u.config=e.extend({},this.defaultComponentConfig,s);d[t]=u;var r=m[t];if(r){r.resolve(u);delete m[t]}};brite.registerComponent=brite.registerView;brite.registerTransition=function(r,s){h[r]=s};brite.getTransition=function(r){return h[r]};brite.display=function(t,s,r){return a(t,s,r)};brite.attach=function(u,r,t,s){return a(u,t,s,r)};brite.config={componentsHTMLHolder:"body",tmplPath:"tmpl/",tmplExt:".tmpl"};brite.defaultComponentConfig={loadTmpl:false,loadCss:false,emptyParent:false,postDisplayDelay:0};function f(r){var t=e.Deferred();var s=j(r);s.done(function(C){var y,z;var u=C.config.loadTmpl;if(u&&!l[r]){var x=true;var E=C.config.checkTemplate;if(E){var B=(typeof E=="string")?E:("#tmpl-"+r);if(e(B).length>0){x=false}}if(x){y=e.Deferred();var D=(typeof u=="string")?D:(r+".html");e.ajax({url:brite.config.tmplPath+r+brite.config.tmplExt,async:true}).complete(function(F,G){e(brite.config.componentsHTMLHolder).append(F.responseText);l[r]=true;y.resolve()})}}var A=C.config.loadCss;if(A){z=e.Deferred();var v="css/"+r+".css";var w=c(v,"css");w.done(function(){z.resolve()}).fail(function(){console.log("Brite ERROR: cannot load "+v+". Ignoring issue");z.resolve()})}e.when(y,z).done(function(){t.resolve(C)})});s.fail(function(u){console.log("BRITE-ERROR: Brite cannot load component: "+r+"\n\t "+u);t.reject()});return t.promise()}function j(s){var r=e.Deferred();var v=d[s];if(v){r.resolve(v)}else{var t="js/"+s+".js";var u=c(t,"js");u.done(function(){v=d[s];if(v){r.resolve(v)}else{r.reject("Component js file ["+t+"] loaded, but it did not seem to have registered the component - it needs to call brite.registerComponent('"+s+"',...config...) - see documentation")}}).fail(function(){r.reject("Component resource file "+t+" not found")})}return r.promise()}function a(r,x,v,A){var t=f(r);var w=e.Deferred();var z=e.Deferred();var u=e.Deferred();var s=e.Deferred();var y=w.promise();y.whenCreate=z.promise();y.whenInit=u.promise();y.whenPostDisplay=s.promise();t.done(function(F){v=n(F,v);var D=k(F);if(v.unique){var B=e("[data-brite-component='"+r+"']");if(B.length>0){D=B.bComponent();w.resolve(D);return w}}var E=e.Deferred();if(!A){var C=i(D,x,v);if(C&&e.isFunction(C.promise)&&!C.jquery){C.done(function(G){E.resolve(G)}).fail(function(){E.reject()})}else{if(C){A=e(C)}E.resolve(A)}}else{E.resolve(A)}E.promise().done(function(G){if(G){G=e(G);g(G,D,x,v);G.data("componentProcessPromise",y);z.resolve(D);e.when(p(D,x,v)).done(function(){q(D,x,v);u.resolve(D)})}else{z.resolve(D);u.resolve(D)}y.whenInit.done(function(){var I,H;if(G&&G.parent()){var J=G.parent().closest("[data-brite-component]");if(J.length>0){I=J.data("componentProcessPromise");if(I){I.whenPostDisplay.done(function(){H=o(D,x,v);H.done(function(){s.resolve(D)})})}}}if(!I){H=o(D,x,v);H.done(function(){s.resolve(D)})}})});y.whenPostDisplay.done(function(){w.resolve(D)})});t.fail(function(){w.reject();z.reject();u.reject();s.reject()});return y}function q(s,t,r){if(r.transition){var u=brite.getTransition(r.transition);if(u){u(s,t,r)}else{brite.log.error("Transition ["+r.transition+"] not found. Transitions need to be registered via brite.registerTranstion(..) before call.")}}else{if(r.replace){e(r.replace).bRemove()}if(r.parent){if(r.emptyParent){e(r.parent).bEmpty()}e(r.parent).append(s.$element)}}}function n(s,r){var t=e.extend({},s.config,r);t.componentName=s.name;return t}function k(t){var r;var s=t.componentFactory;if(s){if(e.isFunction(s)){r=s()}else{if(e.isPlainObject(s)){r=e.extend({},s)}else{brite.log.error("Invalid ComponentFactory for component ["+t.componentName+"]. Only types Function or Object are supported as componentFactory. Empty component will be created.")}}}else{brite.log.error("No ComponentFactory for component ["+t.componentName+"]")}if(r){r.name=t.name;r.cid=b++}return r}function i(s,t,r){var u=s.create||s.build;if(!u||!e.isFunction(u)){brite.log.error("Invalid 'create' function for component ["+s.name+"].");return}return u.call(s,t,r)}function p(s,t,r){var u=s.init;if(e.isFunction(u)){return u.call(s,t,r)}}function g(r,t,u,s){t.$element=r;r.data("component",t);r.attr("data-brite-component",s.componentName);r.attr("data-brite-cid",t.cid)}function o(s,v,r){var u=e.Deferred();if(s.postDisplay){if(r.postDisplayDelay>=0){setTimeout(function(){var w=s.postDisplay(v,r);if(w&&e.isFunction(w.promise)){w.done(function(){u.resolve()})}else{u.resolve()}},r.postDisplayDelay)}else{var t=s.postDisplay(v,r);if(t&&e.isFunction(t.promise)){t.done(function(){u.resolve()})}else{u.resolve()}}}else{u.resolve()}return u.promise()}function c(w,s){var r=e.Deferred();if(s==="js"){var v=document.createElement("script");v.setAttribute("type","text/javascript");v.setAttribute("src",w)}else{if(s==="css"){var v=document.createElement("link");v.setAttribute("rel","stylesheet");v.setAttribute("type","text/css");v.setAttribute("href",w)}}if(s==="js"){v.onload=function(){r.resolve(w)};v.addEventListener("error",function(){r.reject()},true)}else{if(s==="css"){var u=document.getElementsByTagName("html")[0];var t=document.createElement("img");e(t).css("display","none");t.onerror=function(){u.removeChild(t);r.resolve(w)};u.appendChild(t);t.src=w}}if(typeof v!="undefined"){document.getElementsByTagName("head")[0].appendChild(v)}return r.promise()}})(jQuery);(function(c){c.fn=c.fn;c.fn.bComponent=function(d){var e;if(d){e=c(this).closest("[data-brite-component='"+d+"']")}else{e=c(this).closest("[data-brite-component]")}return e.data("component")};c.fn.bFindComponents=function(d){var e=[];this.each(function(){var f=c(this);var g;if(d){g=c(this).find("[data-brite-component='"+d+"']")}else{g=c(this).find("[data-brite-component]")}g.each(function(){var h=c(this);e.push(h.data("component"))})});return e};c.fn.bFindFirstComponent=function(d){var e=[];this.each(function(){var f=c(this);var g;if(d){g=c(this).find("[data-brite-component='"+d+"']:first")}else{g=c(this).find("[data-brite-component]:first")}g.each(function(){var h=c(this);e.push(h.data("component"))})});return e};c.fn.bEmpty=function(){return this.each(function(){var e=c(this);var d=e.bFindComponents();c.each(d,function(g,f){a(f)});e.empty();c.each(d,function(g,f){b(f)})})};c.fn.bRemove=function(){return this.each(function(){var e=c(this);e.bEmpty();if(e.is("[data-brite-component]")){var d=e.data("component");a(d);e.remove();b(d)}else{e.remove()}})};function a(d){if(d){var e=d.destroy||d.preRemove;if(c.isFunction(e)){e.call(d)}}}function b(e){if(e){var d=e.postDestroy||e.postRemove;if(c.isFunction(d)){d.call(e)}}}})(jQuery);(function(f){var c="INFO",d="ERROR",b="DEBUG";var g=null;brite.log={config:{debugMode:false,consoleLog:true},info:function(h){e(h)},error:function(h){e(h,d)},debug:function(h){if(brite.log.config.debugMode){e(h,b)}},addPrinter:function(h){g=g||[];g.push(h)}};function e(o,n){if(brite.log.config.consoleLog){a(o,n)}if(g){var m,k=n||c;for(var j=0,h=g.length;j<h;j++){m=g[j];m(o,k)}}}function a(i,h){if(window.console&&window.console.log){if(h){i=h+" - "+i}console.log(i)}}})(jQuery);(function(c){var b="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");brite.uuid=function(e,h){var j=b,g=[];h=h||j.length;e=e||10;for(var f=0;f<e;f++){g[f]=j[0|Math.random()*h]}return g.join("")};brite.value=function(k,g){if(!k){return k}if(!g){return k}var e;var j,f,m=g.split(".");var h,n=k;for(j=0,f=m.length;j<f;j++){h=m[j];if(n==null){return undefined}n=n[h];if(typeof n==="undefined"){return n}}return n};brite.substract=function(g,f){var e={};c.each(g,function(h,j){var i=f[h];if(!isNaN(j)&&!isNaN(i)){e[h]=j-i}});return e};brite.add=function(g,f){var e={};c.each(g,function(h,j){var i=f[h];if(!isNaN(j)&&!isNaN(i)){e[h]=j+i}});return e};brite.array={remove:function(e,h,g){var f=e.slice((g||h)+1||e.length);e.length=h<0?e.length+h:h;return e.push.apply(e,f)},getIndex:function(f,h,k){if(f&&h&&typeof k!="undefined"){var g,j,e=f.length;for(var g=0;g<e;g++){j=f[g];if(j&&j[h]===k){return g}}}return -1},getItem:function(f,g,h){var e=this.getIndex(f,g,h);if(e>-1){return f[e]}else{return null}},sortBy:function(e,f){return e.sort(g);function g(j,i){if(typeof j==="undefined"){return -1}if(typeof i==="undefined"){return 1}var h=j[f];var k=i[f];return((h<k)?-1:((h>k)?1:0))}},toMap:function(f,j){var h,e=f.length;var m={},k,g;for(h=0;h<e;h++){k=f[h];g=k[j];if(typeof g!="undefined"&&g!=null){m[g]=k}}return m}};brite.randomInt=function(g,f){var e=f-g;return g+Math.floor(Math.random()*(e+1))};brite.inherit=function(g,f){var e=function(){};e.prototype=f.prototype;g.prototype=new e();g._super=f.prototype;g.prototype.constructor=g};var a=2;var d;brite.flushUI=function(){if(brite.ua.hasTouch()){if(!d){d=c("<div id='b-flushUI' style='position:absolute;opacity:1;z-index:-1000;overflow:hidden;width:2px;color:rgba(0,0,0,0)'>flushUI</div>");c("body").append(d)}a=a*-1;d.text("").text(a);d.css("width",a+"px")}}})(jQuery);brite.ua={};(function(g){var u={webkit:"-webkit-",chrome:"-webkit-",mozilla:"-moz-",msie:"-ms-",opera:"-o-"};var r={webkit:"Webkit",mozilla:"Moz",chrome:"Webkit",msie:"ms",opera:"o"};var d=null;var e=null;var v=null;var h=null;var a=null;var m=null;var b=null;var f=null;var q={};var s=null;function n(){g.each(u,function(i,l){if(g.browser[i]){s=i;e=u[i];d=r[i]}})}brite.ua.cssPrefix=function(){if(e===null){n()}return e};brite.ua.cssVarPrefix=function(){if(d===null){n()}return d};var t=["transform"];var j;for(var p=0,o=t.length;p<o;p++){j=t[p];g.cssHooks[j]=new c(j)}function c(i){this.propName=i;this.computedName=d+i.substr(0,1).toUpperCase()+i.substr(1)}c.prototype.get=function(w,l,i){return g.css(w,this.computedName)};c.prototype.set=function(i,l){i.style[this.computedName]=l};brite.ua.cssHas=function(){if(v===null){var i="has";v="";g.each(brite.ua,function(w){var l=brite.ua[w];var x;if(w.indexOf(i)===0&&g.isFunction(l)){if(l.call(brite.ua)){x="has-"+w.substring(i.length).toLowerCase();v+=x+" "}}})}return v};brite.ua.cssHasNo=function(){if(h===null){var i="has";h="";g.each(brite.ua,function(w){var l=brite.ua[w];var x;if(w.indexOf(i)===0&&g.isFunction(l)){if(!l.call(brite.ua)){x="has-no-"+w.substring(i.length).toLowerCase();h+=x+" "}}})}return h};brite.ua.supportsEvent=function(i){var l=q[i];if(typeof l==="undefined"){l=k(i);q[i]=l}return l};brite.ua.hasTouch=function(){return this.supportsEvent("touchstart")};brite.ua.hasCanvas=function(){if(b===null){var i=document.createElement("canvas");b=(i.getContext)?true:false;delete i}return b};brite.ua.hasTransition=function(){if(m===null){var l=document.createElement("div");var i=brite.ua.cssPrefix()+"transition";l.innerHTML='<div style="'+i+': color 1s linear"></div>';if(l.firstChild.style[brite.ua.cssVarPrefix()+"Transition"]){m=true}else{m=false}delete l}return m};var k=(function(){var l={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};function i(w){var y=document.createElement(l[w]||"div");w="on"+w;var x=(w in y);if(!x){y.setAttribute(w,"return;");x=typeof y[w]=="function"}y=null;return x}return i})()})(jQuery);(function(d){brite.gtx=function b(f){var g=f;if(f.jquery){f=f.get(0)}if(d.isFunction(f.getContext)){g=f.getContext("2d")}if(!(this instanceof b)){return new b(g)}this.context=this.ctx=g;if(!this.beginPath){a()}};brite.gtx.prototype.referenceScale=function(g,f){this._refWidth=g;this._refHeight=f;computeRatio.call(this);return this};brite.gtx.prototype.fitParent=function(){var f=this.canvas();if(f){var f=this.canvas();var g=d(f).parent();f.width=g.width();f.height=g.height()}return this};brite.gtx.prototype.clear=function(){if(this.canvas()){this.canvas().width=this.canvas().width}return this};brite.gtx.prototype.createLinearGradient=function(h,j,g,i){var k=this.ctx.createLinearGradient(h,j,g,i);var f=new e(k);return f};brite.gtx.prototype.createRadialGradient=function(j,l,i,h,k,g){var m=this.ctx.createRadialGradient(j,l,i,h,k,g);var f=new e(m);return f};brite.gtx.prototype.fillStyle=function(f){return c(this,"fillStyle",f)};brite.gtx.prototype.strokeStyle=function(f){return c(this,"strokeStyle",f)};function c(i,h,f){if(!f){return i.ctx[h]}if(f.ctxGradient){f=f.ctxGradient}i.ctx[h]=f;return i}function e(f){this.ctxGradient=f}e.prototype.addColorStop=function(){this.ctxGradient.addColorStop.apply(this.ctxGradient,arguments);return this};e.prototype.addColorStops=function(){for(var f=0;(f+1)<arguments.length;f+=2){this.ctxGradient.addColorStop(arguments[f],arguments[f+1])}return this};function a(){var h=["beginPath","clip","closePath","drawImage","fill","fillText","arc","arcTo","lineTo","moveTo","bezierCurveTo","quadraticCurveTo","rect","clearRect","fillRect","strokeRect","translate","rotate","save","scale","setTransform","stroke","strokeText","transform"];var o=["createPattern","drawFocusRing","isPointInPath","measureText","createImageData","getImageData","putImageData"];var q=["canvas","font","globalAlpha","globalCompositeOperation","lineCap","lineJoin","lineWidth","miterLimit","shadowOffsetX","shadowOffsetY","shadowBlur","shadowColor","textAlign","textBaseline"];var g,r;for(var l=0,n=h.length;l<n;l++){var j=h[l];brite.gtx.prototype[j]=(function(i){return function(){this.ctx[i].apply(this.ctx,arguments);return this}}(j))}for(l=0,g=o.length;l<g;l++){var k=o[l];brite.gtx.prototype[k]=(function(i){return function(){return this.ctx[i].apply(this.ctx,arguments)}}(k))}for(l=0,r=q.length;l<r;l++){var f=q[l];brite.gtx.prototype[f]=(function(i){return function(m){if(typeof m==="undefined"){return this.ctx[i]}this.ctx[i]=m;return this}}(f))}}})(jQuery);var brite=brite||{};brite.dao={};brite.data={};(function(h){var r={};var b={};var q={};function l(w){var v=r[w];if(v){return v}else{var x="Cannot find the DAO for objectType: "+w;brite.log.error(x);throw x}}brite.registerDao=function(w,v){r[w]=v;return this};var g="_ALL_";function d(v){var x,B,y,z={};for(x=v.length-1;x>-1;x--){B=v[x];if(h.isFunction(B)){z.func=B}else{if(!z.func){y=B}else{if(z.func&&typeof z.objectTypes==="undefined"){z.objectTypes=B}else{if(z.func&&typeof z.objectTypes!=="undefined"){z.events=B}}}}}if(typeof y==="undefined"){y=brite.uuid()}if(!z.events){z.events=g}else{var w=z.events.split(",");h.each(w,function(C,D){w[C]=h.trim(D)+"."+y});z.events=w.join(", ")}if(z.objectTypes){var A=z.objectTypes.split(",");h.each(A,function(C,D){A[C]="."+h.trim(D)});z.objectTypes=A.join(",")}z.namespace=y;return z}function f(A,x,w,z){var v=h.extend(jQuery.Event(z.action),{daoEvent:z});var y=A[w];if(!y){A[w]=y=h("<div class='"+w+"'></div>");x.append(y)}y.trigger(v);v.type=g;y.trigger(v)}var c=h("<div></div>");var t={};brite.dao.onDao=function(v,z,y,w){var x=d(arguments);c.on(x.events,x.objectTypes,x.func);return x.namespace};brite.dao.offDao=function(v){c.off("."+v)};function s(w,B,x,v,A,y){var z={action:B,objectType:x,objectId:v,data:A,opts:y,resultPromise:w};f(t,c,x,z);o(w,B,x,v,A,y)}var m=h("<div></div>");var u={};brite.dao.onResult=function(v,z,y,w){var x=d(arguments);m.on(x.events,x.objectTypes,x.func);return x.namespace};brite.dao.offResult=function(v){m.off("."+v)};function a(y,w,v){var x={action:y,result:v};f(u,m,w,x)}var j=h("<div></div>");var p={};brite.dao.onDataChange=function(v,z,x,w){var y=d(arguments);j.on(y.events,y.objectTypes,y.func);return y.namespace};brite.dao.offDataChange=function(v){j.off("."+v)};brite.dao.triggerDataChange=function(A,x,w,y,v){var z={action:A,objectType:x,objectId:w,newData:y,saveData:v};f(p,j,x,z)};function e(z,x,w,y,v){brite.dao.triggerDataChange(z,x,w,y,v);i(z,x,w,y,v)}brite.dao.getIdName=function(v){return l(v).getIdName(v)};brite.dao.get=function(x,w){var v=k(l(x).get(x,w));s(v,"get",x,w);v.done(function(y){a("get",x,y)});return v};brite.dao.list=function(w,x){var v=k(l(w).list(w,x));s(v,"list",w,null,null,x);v.done(function(y){a("list",w,y)});return v};brite.dao.create=function(w,x){var v=k(l(w).create(w,x));s(v,"create",w,null,x);v.done(function(y){a("create",w,y);e("create",w,null,y,x)});return v};brite.dao.update=function(x,w,y){var v=k(l(x).update(x,w,y));s(v,"update",x,w,y);v.done(function(z){a("update",x,z);e("update",x,w,z,y)});return v};brite.dao.remove=function(x,w){var v=k(l(x).remove(x,w));s(v,"remove",x,w);v.done(function(y){a("remove",x,w);e("remove",x,w)});return v};brite.dao.invoke=function(y,x){var z=Array.prototype.slice.call(arguments,0);var w=l(x);if(!w){throw ("cannot find dao for "+x)}if(!w[y]){throw ("no custom method for "+y)}var v=k(w[y].apply(w,z.slice(1)));s(v,y,x);v.done(function(A){a(y,x,A);if(w.isDataChange&&w.isDataChange(y)){e("methodName",x,A)}});return v};function k(w){if(w&&h.isFunction(w.promise)){return w}else{var v=h.Deferred();v.resolve(w);return v}}brite.addDaoListener=function(v){var w=brite.uuid();q[w]=v;return w};brite.removeDaoListener=function(v){delete q[v]};brite.addDataChangeListener=function(v,y){var x=brite.uuid();var w=b[v];if(!w){w={};b[v]=w}w[x]=y;return x};brite.removeDataChangeListener=function(v){h.each(b,function(w,x){delete x[v]})};function o(v,A,w,B,z,x){var y={result:v,action:A,type:A,objectType:w,id:B,data:z,opts:x};h.each(q,function(C,D){D(y)})}function i(z,w,A,y,v){var x={action:z,type:z,objectType:w,objectId:A,newData:y,saveData:v};n(x)}function n(w){var v=w.objectType;var x=b[v];if(x){h.each(x,function(y,z){z(w)})}}})(jQuery);(function(b){function a(c){this.init(c)}a.prototype.init=function(c){this._store=c||[];return this};a.prototype.getIdName=function(c){return"id"};a.prototype.get=function(d,e){var c=brite.array.getIndex(this._store,"id",e);return this._store[c]};a.prototype.list=function(c,e){var d=this._store;if(e){if(e.orderBy){d=brite.array.sortBy(d,e.orderBy)}if(e.match){d=b.map(d,function(h,f){var g=true;b.each(e.match,function(j,i){if(h[j]===i){g=g&&true}else{g=false}});return(g)?h:null})}}return d};a.prototype.create=function(c,e){var d=brite.dao.getIdName(c);if(typeof e[d]!=="undefined"){var f="SimpleDao.create error: Id present in data object. Cannot create. You might want to call update instead.";brite.log.debug(f);throw f}e[d]=brite.uuid(12);this._store.push(e);return e};a.prototype.update=function(c,i,g){var e=brite.dao.getIdName(c);var d=g[e];if(typeof d!=="undefined"&&d!=i){var h="SimpleDao.update error: Id in param and data does not match. Cannot update data.";brite.log.debug(h);throw h}delete g[e];var f=this.get(c,i);if(f){b.extend(f,g);return f}};a.prototype.remove=function(d,g){var e=this.get(d,g);var c=brite.array.getIndex(this._store,"id",g);if(c>-1){brite.array.remove(this._store,c)}else{var f="SimpleDao.remove error: Ojbect "+d+"["+g+"] not found. Cannot delete.";brite.log.debug(f);throw f}return g};brite.dao.SimpleDao=a})(jQuery);(function(a){a.fn.bObjRef=function(d){var b=[];var c=null;this.each(function(){var f=a(this);var e;if(d){e=f.closest("[data-obj_type='"+d+"']")}else{e=f.closest("[data-obj_type]")}if(e.length>0){var g={type:e.attr("data-obj_type"),id:e.attr("data-obj_id"),$element:e};b.push(g)}});if(b.length===0){return null}else{if(b.length===1){return b[0]}else{return b}}}})(jQuery);var brite=brite||{};brite.event=brite.event||{};(function(b){var a=brite.ua.hasTouch();brite.event.fixTouchEvent=function(c){if(a){var d=c.originalEvent;if(d.touches.length>0){c.pageX=d.touches[0].pageX;c.pageY=d.touches[0].pageY}}return c};brite.event.eventPagePosition=function(f){var d,c;if(f.originalEvent&&f.originalEvent.touches){d=f.originalEvent.touches[0].pageX;c=f.originalEvent.touches[0].pageY}else{d=f.pageX;c=f.pageY}return{pageX:d,pageY:c}}})(jQuery);(function(b){b.fn.bTransition=function(c){return this.each(function(){var e=b(this);var d=-1;if(typeof c.onTimeout==="boolean"){d=(c.onTimeout)?0:-1}else{if(typeof c.onTimeout==="number"){d=c.onTimeout}}if(d>-1){setTimeout(function(){a(e,c)},d)}else{a(e,c)}})};function a(d,c){var e=brite.ua.cssPrefix();d.css(e+"transition",c.transition);d.css(e+"transform",c.transform)}})(jQuery);(function(f){var o=false;var p={start:"mousedown",move:"mousemove",end:"mouseup"};var i={start:"touchstart",move:"touchmove",end:"touchend"};function b(){if(brite.ua.hasTouch()){return i}else{return p}}f.event.special.btap={setup:function(s,r){var q=b();f(this).on(q.start,function(y){var x=this;var u=f(x);var w=y.target,t=y,A;function z(B){v();if(B.target===w&&!o){brite.event.fixTouchEvent(t);h(x,B,{type:"btap",pageX:t.pageX,pageY:t.pageY})}}function v(){clearTimeout(A);u.off(q.end,z)}u.on(q.end,z);A=setTimeout(function(){if(!o){brite.event.fixTouchEvent(t);h(x,t,{type:"btaphold"})}},750)})}};k(["btaphold"],"btap");var l="bdragstart",m="bdragmove",n="bdragend";var c="bdragenter",a="bdragover",g="bdragleave",d="bdrop";var j=5;f(function(){});f.event.special[m]={setup:function(s,r){var q=b();f(this).on(q.start,function(t){var w=this;var u=f(this);var v=false;var A=t;var z=brite.event.eventPagePosition(A);var C=t.target;var x=f(C);var y=f(document);var B="_"+brite.uuid(7);y.on(q.move+"."+B,function(F){var D=brite.event.eventPagePosition(F);f("body").css("-webkit-user-select","none");if(!v){if(Math.abs(z.pageX-D.pageX)>j||Math.abs(z.pageY-D.pageY)>j){v=true;o=true;x.data("bDragCtx",{});var E=e(F,x,l);h(C,F,{type:l,target:C,bextra:E});F.stopPropagation();F.preventDefault()}}if(v){var E=e(F,x,m);h(C,F,{type:m,target:C,bextra:E});F.stopPropagation();F.preventDefault()}});y.on(q.end+"."+B,function(E){f("body").css("-webkit-user-select","");if(v){var D=e(E,x,n);h(C,E,{type:n,target:C,bextra:D});E.stopPropagation();E.preventDefault()}y.off("."+B);o=false})})}};k([l,n],m);function e(u,r,t){brite.event.fixTouchEvent(u);var v=brite.ua.hasTouch();var q={eventSource:u,pageX:u.pageX,pageY:u.pageY};var w=u.originalEvent;if(v){q.touches=w.touches}var s=r.data("bDragCtx");if(t===l){s.startPageX=q.startPageX=q.pageX;s.startPageY=q.startPageY=q.pageY;s.lastPageX=s.startPageX=q.startPageX;s.lastPageY=s.startPageY=q.startPageY}else{if(t===n){q.pageX=s.lastPageX;q.pageY=s.lastPageY}}q.startPageX=s.startPageX;q.startPageY=s.startPageY;q.deltaX=q.pageX-s.lastPageX;q.deltaY=q.pageY-s.lastPageY;s.lastPageX=q.pageX;s.lastPageY=q.pageY;return q}f.event.special.btransitionend={setup:function(s,r){var q="transitionend";if(this.addEventListener){if(!f.browser.mozilla){q=brite.ua.cssVarPrefix().toLowerCase()+"TransitionEnd"}this.addEventListener(q,function(t){h(this,t,{type:"btransitionend"})})}else{h(this,jQuery.Event("btransitionend"),{type:"btransitionend"})}}};function k(r,q){f.each(r,function(s,t){f.event.special[t]={setup:function(){f(this).bind(q,f.noop)}}})}function h(s,q,r){var t=jQuery.extend(new jQuery.Event(),q,r);f(s).trigger(t)}})(jQuery);