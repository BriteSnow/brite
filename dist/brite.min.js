var brite=brite||{};brite.version="0.9.0-snapshot";(function(b){var c="._docevents_";var n=0;var i={};var f={};var q={};var e={};brite.registerView=function(v,u,x){var w={};w.name=v;w.componentFactory=x;w.config=b.extend({},this.defaultComponentConfig,u);i[v]=w;var t=q[v];if(t){t.resolve(w);delete q[v]}};brite.registerComponent=brite.registerView;brite.registerTransition=function(t,u){e[t]=u};brite.getTransition=function(t){return e[t]};brite.display=function(v,u,t){return k(v,u,t)};brite.attach=function(w,t,v,u){return k(w,v,u,t)};brite.config={componentsHTMLHolder:"body",tmplPath:"tmpl/",tmplExt:".tmpl"};brite.viewDefaultConfig={loadTmpl:false,loadCss:false,emptyParent:false,postDisplayDelay:0};brite.defaultComponentConfig=brite.viewDefaultConfig;function s(t){var v=b.Deferred();var u=h(t);u.done(function(E){var A,B;var w=E.config.loadTmpl;if(w&&!f[t]){var z=true;var G=E.config.checkTemplate;if(G){var D=(typeof G=="string")?G:("#tmpl-"+t);if(b(D).length>0){z=false}}if(z){A=b.Deferred();var F=(typeof w=="string")?F:(t+".html");b.ajax({url:brite.config.tmplPath+t+brite.config.tmplExt,async:true}).complete(function(H,I){b(brite.config.componentsHTMLHolder).append(H.responseText);f[t]=true;A.resolve()})}}var C=E.config.loadCss;if(C){B=b.Deferred();var x="css/"+t+".css";var y=d(x,"css");y.done(function(){B.resolve()}).fail(function(){console.log("Brite ERROR: cannot load "+x+". Ignoring issue");B.resolve()})}b.when(A,B).done(function(){v.resolve(E)})});u.fail(function(w){console.log("BRITE-ERROR: Brite cannot load component: "+t+"\n\t "+w);v.reject()});return v.promise()}function h(u){var t=b.Deferred();var x=i[u];if(x){t.resolve(x)}else{var v="js/"+u+".js";var w=d(v,"js");w.done(function(){x=i[u];if(x){t.resolve(x)}else{t.reject("Component js file ["+v+"] loaded, but it did not seem to have registered the component - it needs to call brite.registerComponent('"+u+"',...config...) - see documentation")}}).fail(function(){t.reject("Component resource file "+v+" not found")})}return t.promise()}function k(t,z,x,C){var v=s(t);var y=b.Deferred();var B=b.Deferred();var w=b.Deferred();var u=b.Deferred();var A=y.promise();A.whenCreate=B.promise();A.whenInit=w.promise();A.whenPostDisplay=u.promise();v.done(function(H){x=m(H,x);var F=r(H);if(x.unique){var D=b("[data-b-view='"+t+"']");if(D.length>0){F=D.bComponent();y.resolve(F);return y}}var G=b.Deferred();if(!C){var E=l(F,z,x);if(E&&b.isFunction(E.promise)&&!E.jquery){E.done(function(I){G.resolve(I)}).fail(function(){G.reject()})}else{if(E){C=b(E)}G.resolve(C)}}else{G.resolve(C)}G.promise().done(function(I){if(I){I=b(I);o(I,F,z,x);I.data("componentProcessPromise",A);B.resolve(F);b.when(j(F,z,x)).done(function(){p(F,z,x);w.resolve(F)})}else{B.resolve(F);w.resolve(F)}A.whenInit.done(function(){var K,J;if(I&&I.parent()){var L=I.parent().closest("[data-b-view]");if(L.length>0){K=L.data("componentProcessPromise");if(K){K.whenPostDisplay.done(function(){J=g(F,z,x);J.done(function(){u.resolve(F)})})}}}if(!K){J=g(F,z,x);J.done(function(){u.resolve(F)})}})});A.whenPostDisplay.done(function(){y.resolve(F)})});v.fail(function(){y.reject();B.reject();w.reject();u.reject()});return A}function p(u,v,t){if(t.transition){var w=brite.getTransition(t.transition);if(w){w(u,v,t)}else{brite.log.error("Transition ["+t.transition+"] not found. Transitions need to be registered via brite.registerTranstion(..) before call.")}}else{if(t.replace){b(t.replace).bRemove()}if(t.parent){if(t.emptyParent){b(t.parent).bEmpty()}b(t.parent).append(u.$element)}}}function m(u,t){var v=b.extend({},u.config,t);v.componentName=u.name;return v}function r(v){var t;var u=v.componentFactory;if(u){if(b.isFunction(u)){t=u()}else{if(b.isPlainObject(u)){t=b.extend({},u)}else{brite.log.error("Invalid ComponentFactory for component ["+v.componentName+"]. Only types Function or Object are supported as componentFactory. Empty component will be created.")}}}else{brite.log.error("No ComponentFactory for component ["+v.componentName+"]")}if(t){t.name=v.name;t.cid=t.id="bview_"+n++}return t}function l(u,v,t){var w=u.create||u.build;if(!w||!b.isFunction(w)){brite.log.error("Invalid 'create' function for component ["+u.name+"].");return}return w.call(u,v,t)}function j(u,v,t){var w=u.init;if(b.isFunction(w)){return w.call(u,v,t)}}function o(t,v,w,u){v.el=t[0];v.$el=v.$element=t;t.data("component",v);t.attr("data-b-view",u.componentName);t.attr("data-brite-cid",v.cid)}function g(u,x,t){var w=b.Deferred();if(u.events){a(u.events,u.$el,u)}if(u.docEvents){a(u.docEvents,b(document),u,c+u.id)}if(u.postDisplay){if(t.postDisplayDelay>=0){setTimeout(function(){var y=u.postDisplay(x,t);if(y&&b.isFunction(y.promise)){y.done(function(){w.resolve()})}else{w.resolve()}},t.postDisplayDelay)}else{var v=u.postDisplay(x,t);if(v&&b.isFunction(v.promise)){v.done(function(){w.resolve()})}else{w.resolve()}}}else{w.resolve()}return w.promise()}function a(v,w,t,u){b.each(v,function(y,C){var x=y.split(" ");var z=x[0]+((u)?u:"");var B=x.slice(1).join(" ");var A=C;if(!b.isFunction(A)){A=t[A]}if(A){w.on(z,B,function(){var D=b.makeArray(arguments);A.apply(t,D)})}else{throw"BRITE ERROR: '"+t.name+"' component event handler function '"+C+"' not found."}})}function d(y,u){var t=b.Deferred();if(u==="js"){var x=document.createElement("script");x.setAttribute("type","text/javascript");x.setAttribute("src",y)}else{if(u==="css"){var x=document.createElement("link");x.setAttribute("rel","stylesheet");x.setAttribute("type","text/css");x.setAttribute("href",y)}}if(u==="js"){x.onload=function(){t.resolve(y)};x.addEventListener("error",function(){t.reject()},true)}else{if(u==="css"){var w=document.getElementsByTagName("html")[0];var v=document.createElement("img");b(v).css("display","none");v.onerror=function(){w.removeChild(v);t.resolve(y)};w.appendChild(v);v.src=y}}if(typeof x!="undefined"){document.getElementsByTagName("head")[0].appendChild(x)}return t.promise()}})(jQuery);(function(c){var b="._docevents_";c.fn.bEmpty=function(){return this.each(function(){var e=c(this);var d=e.bFindComponents();c.each(d,function(g,f){a(f)});e.empty()})};c.fn.bRemove=function(){return this.each(function(){var e=c(this);e.bEmpty();if(e.is("[data-b-view]")){var d=e.data("component");a(d);e.remove()}else{e.remove()}})};function a(d){if(d){c(document).off(b+d.id);var e=d.destroy;if(c.isFunction(e)){e.call(d)}}}})(jQuery);(function(a){a.fn.bComponent=function(b){var c;if(b){c=a(this).closest("[data-b-view='"+b+"']")}else{c=a(this).closest("[data-b-view]")}return c.data("component")};a.fn.bFindComponents=function(b){var c=[];this.each(function(){var d=a(this);var e;if(b){e=a(this).find("[data-b-view='"+b+"']")}else{e=a(this).find("[data-b-view]")}e.each(function(){var f=a(this);c.push(f.data("component"))})});return c};a.fn.bFindFirstComponent=function(b){var c=[];this.each(function(){var d=a(this);var e;if(b){e=a(this).find("[data-b-view='"+b+"']:first")}else{e=a(this).find("[data-b-view]:first")}e.each(function(){var f=a(this);c.push(f.data("component"))})});return c}})(jQuery);(function(d){var b={failOnFirst:true};brite.whenEach=function(g,m,l){var f=d.Deferred();var k=[];var j=0;l=d.extend({},b,l);h();function h(){if(j<g.length){var n=g[j];var i=m(n,j);if(typeof i!=="undefined"&&i!==null&&d.isFunction(i.promise)&&!i.jquery){i.done(function(o){k.push(o);j++;h()});i.fail(function(p){var o=d.map(function(r,q){return{success:true,value:r}});o.push({success:false,value:p});f.reject(o)})}else{k.push(i);j++;h()}}else{f.resolve(k)}}return f.promise()};var c="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");brite.uuid=function(f,j){var k=c,h=[];j=j||k.length;f=f||10;for(var g=0;g<f;g++){h[g]=k[0|Math.random()*j]}return h.join("")};brite.value=function(m,h){if(!m){return m}if(!h){return m}var f;var k,g,n=h.split(".");var j,o=m;for(k=0,g=n.length;k<g;k++){j=n[k];if(o==null){return undefined}o=o[j];if(typeof o==="undefined"){return o}}return o};brite.substract=function(h,g){var f={};d.each(h,function(i,k){var j=g[i];if(!isNaN(k)&&!isNaN(j)){f[i]=k-j}});return f};brite.add=function(h,g){var f={};d.each(h,function(i,k){var j=g[i];if(!isNaN(k)&&!isNaN(j)){f[i]=k+j}});return f};brite.array={remove:function(f,i,h){var g=f.slice((h||i)+1||f.length);f.length=i<0?f.length+i:i;return f.push.apply(f,g)},getIndex:function(g,j,m){if(g&&j&&typeof m!="undefined"){var h,k,f=g.length;for(var h=0;h<f;h++){k=g[h];if(k&&k[j]===m){return h}}}return -1},getItem:function(g,h,i){var f=this.getIndex(g,h,i);if(f>-1){return g[f]}else{return null}},sortBy:function(f,g){return f.sort(h);function h(k,j){if(typeof k==="undefined"){return -1}if(typeof j==="undefined"){return 1}var i=k[g];var l=j[g];return((i<l)?-1:((i>l)?1:0))}},toMap:function(g,k){var j,f=g.length;var n={},m,h;for(j=0;j<f;j++){m=g[j];h=m[k];if(typeof h!="undefined"&&h!=null){n[h]=m}}return n}};brite.randomInt=function(h,g){var f=g-h;return h+Math.floor(Math.random()*(f+1))};brite.inherit=function(h,g){var f=function(){};f.prototype=g.prototype;h.prototype=new f();h._super=g.prototype;h.prototype.constructor=h};var a=2;var e;brite.flushUI=function(){if(brite.ua.hasTouch()){if(!e){e=d("<div id='b-flushUI' style='position:absolute;opacity:1;z-index:-1000;overflow:hidden;width:2px;color:rgba(0,0,0,0)'>flushUI</div>");d("body").append(e)}a=a*-1;e.text("").text(a);e.css("width",a+"px")}}})(jQuery);brite.ua={};(function(f){var e={webkit:"-webkit-",chrome:"-webkit-",mozilla:"-moz-",msie:"-ms-",opera:"-o-"};var j={webkit:"Webkit",mozilla:"Moz",chrome:"Webkit",msie:"ms",opera:"o"};var a=null;var d=null;var m=null;var h=null;var i=null;var o=null;var c=null;var k=null;var b={};var g=null;function l(){f.each(e,function(p,q){if(f.browser[p]){g=p;d=e[p];a=j[p]}})}brite.ua.cssPrefix=function(){if(d===null){l()}return d};brite.ua.cssVarPrefix=function(){if(a===null){l()}return a};brite.ua.cssHas=function(){if(m===null){var p="has";m="";f.each(brite.ua,function(r){var q=brite.ua[r];var s;if(r.indexOf(p)===0&&f.isFunction(q)){if(q.call(brite.ua)){s="has-"+r.substring(p.length).toLowerCase();m+=s+" "}}})}return m};brite.ua.cssHasNo=function(){if(h===null){var p="has";h="";f.each(brite.ua,function(r){var q=brite.ua[r];var s;if(r.indexOf(p)===0&&f.isFunction(q)){if(!q.call(brite.ua)){s="has-no-"+r.substring(p.length).toLowerCase();h+=s+" "}}})}return h};brite.ua.supportsEvent=function(p){var q=b[p];if(typeof q==="undefined"){q=n(p);b[p]=q}return q};brite.ua.hasTouch=function(){return this.supportsEvent("touchstart")};brite.ua.hasCanvas=function(){if(c===null){var p=document.createElement("canvas");c=(p.getContext)?true:false;delete p}return c};brite.ua.hasTransition=function(){if(o===null){var q=document.createElement("div");var p=brite.ua.cssPrefix()+"transition";q.innerHTML='<div style="'+p+': color 1s linear"></div>';if(q.firstChild.style[brite.ua.cssVarPrefix()+"Transition"]){o=true}else{o=false}delete q}return o};var n=(function(){var q={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};function p(r){var t=document.createElement(q[r]||"div");r="on"+r;var s=(r in t);if(!s){t.setAttribute(r,"return;");s=typeof t[r]=="function"}t=null;return s}return p})()})(jQuery);(function(d){brite.gtx=function b(f){var g=f;if(f.jquery){f=f.get(0)}if(d.isFunction(f.getContext)){g=f.getContext("2d")}if(!(this instanceof b)){return new b(g)}this.context=this.ctx=g;if(!this.beginPath){a()}};brite.gtx.prototype.referenceScale=function(g,f){this._refWidth=g;this._refHeight=f;computeRatio.call(this);return this};brite.gtx.prototype.fitParent=function(){var f=this.canvas();if(f){var f=this.canvas();var g=d(f).parent();f.width=g.width();f.height=g.height()}return this};brite.gtx.prototype.clear=function(){if(this.canvas()){this.canvas().width=this.canvas().width}return this};brite.gtx.prototype.createLinearGradient=function(h,j,g,i){var k=this.ctx.createLinearGradient(h,j,g,i);var f=new e(k);return f};brite.gtx.prototype.createRadialGradient=function(j,l,i,h,k,g){var m=this.ctx.createRadialGradient(j,l,i,h,k,g);var f=new e(m);return f};brite.gtx.prototype.fillStyle=function(f){return c(this,"fillStyle",f)};brite.gtx.prototype.strokeStyle=function(f){return c(this,"strokeStyle",f)};function c(i,h,f){if(!f){return i.ctx[h]}if(f.ctxGradient){f=f.ctxGradient}i.ctx[h]=f;return i}function e(f){this.ctxGradient=f}e.prototype.addColorStop=function(){this.ctxGradient.addColorStop.apply(this.ctxGradient,arguments);return this};e.prototype.addColorStops=function(){for(var f=0;(f+1)<arguments.length;f+=2){this.ctxGradient.addColorStop(arguments[f],arguments[f+1])}return this};function a(){var h=["beginPath","clip","closePath","drawImage","fill","fillText","arc","arcTo","lineTo","moveTo","bezierCurveTo","quadraticCurveTo","rect","clearRect","fillRect","strokeRect","translate","rotate","save","scale","setTransform","stroke","strokeText","transform"];var o=["createPattern","drawFocusRing","isPointInPath","measureText","createImageData","getImageData","putImageData"];var q=["canvas","font","globalAlpha","globalCompositeOperation","lineCap","lineJoin","lineWidth","miterLimit","shadowOffsetX","shadowOffsetY","shadowBlur","shadowColor","textAlign","textBaseline"];var g,r;for(var l=0,n=h.length;l<n;l++){var j=h[l];brite.gtx.prototype[j]=(function(i){return function(){this.ctx[i].apply(this.ctx,arguments);return this}}(j))}for(l=0,g=o.length;l<g;l++){var k=o[l];brite.gtx.prototype[k]=(function(i){return function(){return this.ctx[i].apply(this.ctx,arguments)}}(k))}for(l=0,r=q.length;l<r;l++){var f=q[l];brite.gtx.prototype[f]=(function(i){return function(m){if(typeof m==="undefined"){return this.ctx[i]}this.ctx[i]=m;return this}}(f))}}})(jQuery);var brite=brite||{};(function(g){var p={};var b={};var m={};function j(u){var t=p[u];if(t){return t}else{var v="Cannot find the DAO for objectType: "+u;brite.log.error(v);throw v}}brite.dao=function(t){return j(t)};brite.registerDao=function(u,t){return this};var o={getIdName:true,isDataChange:true};var n={create:true,remove:true,removeMany:true,update:true,updateMany:true};brite.registerDao=function(u,v){var t={};v._entityType=u;t._entityType=u;t._handler=v;g.each(v,function(y,x){if(g.isFunction(v[y])&&!o[y]){var w=y;var z=n[w];if(v.isDataChange){z=z||v.isDataChange(w)}t[w]=(function(A,B,C){return function(){var E=v[B].apply(v,arguments);var D=i(E);q(A,B,D);D.done(function(F){a(A,B,F);if(C){brite.triggerDataChange(A,B,F)}});return D}})(u,w,z)}});p[u]=t;if(g.isFunction(t.init)){t.init(u)}return t};var f="_ALL_";function d(t){var v,z,w,x={};for(v=t.length-1;v>-1;v--){z=t[v];if(g.isFunction(z)){x.func=z}else{if(!x.func){w=z}else{if(x.func&&typeof x.objectTypes==="undefined"){x.objectTypes=z}else{if(x.func&&typeof x.objectTypes!=="undefined"){x.events=z}}}}}if(typeof w==="undefined"){throw"BRITE DAO BINDING ERROR: any binding with brite.dao.on*** needs to have a namespace after the function.  Remember to cleanup the event at component close with brite.dao.off(mynamespace)"}if(!x.events){x.events=f+"."+w}else{var u=x.events.split(",");g.each(u,function(A,B){u[A]=g.trim(B)+"."+w});x.events=u.join(" ")}if(x.objectTypes){var y=x.objectTypes.split(",");g.each(y,function(A,B){y[A]="."+g.trim(B)});x.objectTypes=y.join(",")}x.namespace=w;return x}function e(y,v,u,x){var t=g.extend(jQuery.Event(x.action),{daoEvent:x});var w=y[u];if(!w){y[u]=w=g("<div class='"+u+"'></div>");v.append(w)}w.trigger(t);t.type=f;w.trigger(t)}var c=g("<div></div>");var r={};brite.dao.onDao=function(t,x,w,u){var v=d(arguments);c.on(v.events,v.objectTypes,v.func);return v.namespace};brite.dao.offDao=function(t){c.off("."+t)};function q(u,w,t){var v={entityType:u,action:w,resultPromise:t};e(r,c,u,v)}var k=g("<div></div>");var s={};brite.dao.onResult=function(t,x,w,u){var v=d(arguments);k.on(v.events,v.objectTypes,v.func);return v.namespace};brite.dao.offResult=function(t){k.off("."+t)};function a(u,w,t){var v={entityType:u,action:w,result:t};e(s,k,u,v)}var h=g("<div></div>");var l={};brite.dao.onDataChange=function(t,x,v,u){var w=d(arguments);h.on(w.events,w.objectTypes,w.func);return w.namespace};brite.dao.offDataChange=function(t){h.off("."+t)};brite.triggerDataChange=function(u,w,t){var v={entityType:u,action:w,result:t};e(l,h,u,v)};brite.dao.offAny=function(t){brite.dao.offResult(t);brite.dao.offDao(t);brite.dao.offDataChange(t)};function i(u){if(u&&g.isFunction(u.promise)){return u}else{var t=g.Deferred();t.resolve(u);return t}}})(jQuery);(function(a){a.fn.bEntity=function(d){var c,b=null;this.each(function(){if(b===null){var f=a(this);var e;if(d){e=f.closest("[data-entity='"+d+"']")}else{e=f.closest("[data-entity]")}if(e.length>0){b={type:e.attr("data-entity"),id:e.attr("data-entity-id"),name:e.attr("data-entity-name"),$el:e}}}});return b}})(jQuery);(function(a){a.fn.bObjRef=function(d){var b=[];var c=null;this.each(function(){var f=a(this);var e;if(d){e=f.closest("[data-obj_type='"+d+"']")}else{e=f.closest("[data-obj_type]")}if(e.length>0){var g={type:e.attr("data-obj_type"),id:e.attr("data-obj_id"),$element:e};b.push(g)}});if(b.length===0){return null}else{if(b.length===1){return b[0]}else{return b}}}})(jQuery);(function(d){var b={idName:"id"};function c(f,g){e.call(this,f,g)}function e(f,g){this._opts=d.extend({},b,g);this._idName=this._opts.idName;a.call(this,f)}function a(f){var h=this._dataDic={};var g=this._idName;if(d.isArray(f)){d.each(f,function(i,j){var k=j[g];if(typeof k==="undefined"){k=brite.uuid();j[g]=k}h[k]=j})}}c.prototype.getIdName=function(){return this._idName||"id"};c.prototype.get=function(g){var f=this._dataDic[g];if(f){return d.extend({},f)}else{return f}};c.prototype.create=function(g){if(g){var f=brite.uuid();g[this._idName]=f;this._dataDic[f]=g}return d.extend({},g)};c.prototype.remove=function(g){var f=this._dataDic[g];if(f){delete this._dataDic[g]}return g};c.prototype.removeMany=function(f){var g=this;d.each(f,function(h,i){delete g._dataDic[i]});return f};c.prototype.update=function(g){var h=g[this._idName];if(typeof h==="undefined"){throw"BRITE ERROR: InMemoryDaoHandler.update: data does not have an id property. Cannot update."}var f=this._dataDic[h];if(f){delete g[this._idName];d.extend(f,g);return d.extend({},f)}else{return null}};c.prototype.list=function(h){h=h||{};var f=[];d.each(this._dataDic,function(l,j){var i,n=true;if(h.match){var m=h.match;for(i in m){if(j[i]!==m[i]){n=false;break}}}if(n){f.push(j)}});if(h.orderBy){f.sort(function(j,i){var k=true;if(h.orderType&&h.orderType.toLowerCase()=="desc"){k=false}var l=j[h.orderBy]>=i[h.orderBy]?1:-1;if(!k){l=l*-1}return l})}if(h.pageIndex||h.pageIndex==0){if(h.pageSize){newResults=f.slice(h.pageIndex*h.pageSize,(h.pageIndex+1)*h.pageSize)}else{if(h.pageSize!=0){newResults=f.slice(h.pageIndex*h.pageSize)}}}var g=d.map(f,function(i){return d.extend({},i)});return g};brite.InMemoryDaoHandler=c})(jQuery);var brite=brite||{};brite.event=brite.event||{};(function(b){var a=brite.ua.hasTouch();brite.event.fixTouchEvent=function(c){if(a){var d=c.originalEvent;if(d.touches.length>0){c.pageX=d.touches[0].pageX;c.pageY=d.touches[0].pageY}}return c};brite.event.eventPagePosition=function(f){var d,c;if(f.originalEvent&&f.originalEvent.touches){d=f.originalEvent.touches[0].pageX;c=f.originalEvent.touches[0].pageY}else{d=f.pageX;c=f.pageY}return{pageX:d,pageY:c}}})(jQuery);(function(b){b.fn.bTransition=function(c){return this.each(function(){var e=b(this);var d=-1;if(typeof c.onTimeout==="boolean"){d=(c.onTimeout)?0:-1}else{if(typeof c.onTimeout==="number"){d=c.onTimeout}}if(d>-1){setTimeout(function(){a(e,c)},d)}else{a(e,c)}})};function a(d,c){d.css("transition",c.transition);d.css("transform",c.transform)}})(jQuery);(function(f){var o=false;var p={start:"mousedown",move:"mousemove",end:"mouseup"};var i={start:"touchstart",move:"touchmove",end:"touchend"};function b(){if(brite.ua.hasTouch()){return i}else{return p}}f.event.special.btap={setup:function(s,r){var q=b();f(this).on(q.start,function(y){var x=this;var u=f(x);var w=y.target,t=y,A;function z(B){v();if(B.target===w&&!o){brite.event.fixTouchEvent(t);h(x,B,{type:"btap",pageX:t.pageX,pageY:t.pageY})}}function v(){clearTimeout(A);u.off(q.end,z)}u.on(q.end,z);A=setTimeout(function(){if(!o){brite.event.fixTouchEvent(t);h(x,t,{type:"btaphold"})}},750)})}};k(["btaphold"],"btap");var l="bdragstart",m="bdragmove",n="bdragend";var c="bdragenter",a="bdragover",g="bdragleave",d="bdrop";var j=5;f(function(){});f.event.special[m]={setup:function(s,r){var q=b();f(this).on(q.start,function(t){var w=this;var u=f(this);var v=false;var A=t;var z=brite.event.eventPagePosition(A);var C=t.target;var x=f(C);var y=f(document);var B="_"+brite.uuid(7);y.on(q.move+"."+B,function(F){var D=brite.event.eventPagePosition(F);f("body").css("-webkit-user-select","none");if(!v){if(Math.abs(z.pageX-D.pageX)>j||Math.abs(z.pageY-D.pageY)>j){v=true;o=true;x.data("bDragCtx",{});var E=e(F,x,l);h(C,F,{type:l,target:C,bextra:E});F.stopPropagation();F.preventDefault()}}if(v){var E=e(F,x,m);h(C,F,{type:m,target:C,bextra:E});F.stopPropagation();F.preventDefault()}});y.on(q.end+"."+B,function(E){f("body").css("-webkit-user-select","");if(v){var D=e(E,x,n);h(C,E,{type:n,target:C,bextra:D});E.stopPropagation();E.preventDefault()}y.off("."+B);o=false})})}};k([l,n],m);function e(u,r,t){brite.event.fixTouchEvent(u);var v=brite.ua.hasTouch();var q={eventSource:u,pageX:u.pageX,pageY:u.pageY};var w=u.originalEvent;if(v){q.touches=w.touches}var s=r.data("bDragCtx");if(t===l){s.startPageX=q.startPageX=q.pageX;s.startPageY=q.startPageY=q.pageY;s.lastPageX=s.startPageX=q.startPageX;s.lastPageY=s.startPageY=q.startPageY}else{if(t===n){q.pageX=s.lastPageX;q.pageY=s.lastPageY}}q.startPageX=s.startPageX;q.startPageY=s.startPageY;q.deltaX=q.pageX-s.lastPageX;q.deltaY=q.pageY-s.lastPageY;s.lastPageX=q.pageX;s.lastPageY=q.pageY;return q}f.event.special.btransitionend={setup:function(s,r){var q="transitionend";if(this.addEventListener){if(!f.browser.mozilla){q=brite.ua.cssVarPrefix().toLowerCase()+"TransitionEnd"}this.addEventListener(q,function(t){h(this,t,{type:"btransitionend"})})}else{h(this,jQuery.Event("btransitionend"),{type:"btransitionend"})}}};function k(r,q){f.each(r,function(s,t){f.event.special[t]={setup:function(){f(this).bind(q,f.noop)}}})}function h(s,q,r){var t=jQuery.extend(new jQuery.Event(),q,r);f(s).trigger(t)}})(jQuery);